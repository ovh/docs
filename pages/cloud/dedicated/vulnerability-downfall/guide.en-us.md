---
title: How to mitigate the Downfall vulnerability
excerpt: 'Learn about the CVE-2022-40982/Gather Data Sampling (GDS)/Downfall vulnerability and its impacts on OVHcloud products'
updated: 2023-08-10
---

## Introduction

On August 8th 2023, Intel has issued a security bulletin disclosing a vulnerability in its recent computer processor microarchitecture. Named "Gather Data Sampling (GDS)" by Intel, the vulnerability is also known as "Downfall".<br>
Labelled CVE-2022-40982 and rated by Intel as Medium, the issue allows an attacker to potentially access sensitive information processed by the CPU in specific circumstances.<br>
The issue affects all software running on the affected processors, including virtual machines, sandboxes, containers, and processes. Exploitation software has been released by the researchers.

At least the following microarchitectures are vulnerable:

- Skylake
- Kaby Lake
- Ice Lake
- Comet Lake
- Rocket Lake
- Tiger Lake

## Impacts on OVHcloud products

In response to that event, we immediately reviewed the security bulletin and technical information and determined the following potential impact on our products:

| Range of products     | Products                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Impact               |
|-----------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------|
| Public Cloud          | All products                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | Impacted             |
| Hosted Private Cloud  | Premier / vSphere / vSAN / NSX-T                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Impacted             |
| Hosted Private Cloud  | SDDC / Essentials                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Not impacted         |
| Hosted Private Cloud  | Nutanix                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Impacted             |
| Hosted Private Cloud  | SAP                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | Impacted             |
| Web Hosting & Domains | Cloud Web                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | Impacted             |
| Web Hosting & Domains | All other products                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Not impacted         |
| Bare Metal Cloud      | ADVANCE-1<br>ADVANCE-1 Gen 2<br>ADVANCE-2<br>ADVANCE-2 Gen 2<br>ADVANCE-5<br>ADVANCE-APAC<br>ADVANCE-LE<br>BF-GAME-1<br>BF-GAME-2<br>BFSTOR21-3<br>GAME-LE-1<br>HGR-HCI-3<br>HGR-SDS-1<br>HGR-STOR-1<br>INFRA-1<br>INFRA-2<br>INFRA-4<br>RISE-1<br>RISE-2<br>RISE-3<br>RISE-5<br>RISE-LE-1<br>RISE-LE-2<br>SCALE-4<br>SCALE-5<br>SCALE-6<br>SYS-4-SAT-32<br>SYS-4-SSD-16<br>SYS-4-SSD-32<br>SYS-5-SAT-32<br>SYS-5-SAT-64<br>SYS-5-SSD-32<br>SYS-5-SSD-64<br>SYS-GAME-1<br>SYS-GAME-2<br>SYS-LE-1<br>SYS-LE-2<br>SYS-LE-3<br>SYS-LE-4 | Potentially impacted |
| Bare Metal Cloud      | Other commercial ranges of dedicated servers                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | Not impacted         |
## How to mitigate the vulnerability

### Customer-initiated mitigation

#### Loading a patched microcode at boot with a firmware package update

This solution will trigger the update of the processor microcode through an operating system update (the linux-firmware package for instance).
You might do it as soon your OS editor or community distribute the updated package. This method is dependent on your distribution or Operating System editor and will only work if the appropriate microcode has been provided by Intel.

#### Mitigation with an updated kernel

When an update of the microcode is not available via a firmware update package, you may update the Kernel with a version that implements a way to shut off AVX instruction set support.

It can be achieved to add the following kernel command line parameter:

```bash
gather_data_sampling=force
```

We recommend using this mitigation carefully since it may have a deep impact on the overall performance of the system.

### OVHcloud-initiated mitigation

OVHcloud teams are working to implement transparent solutions that will ensure the patched microcode is updated in a transparent way for our customers. Those solutions will be deployed progressively on our servers using the solution detailed below.

#### Using OVHcloud iPXE

The microcode update may be loaded by the bootloader when the standard OVHcloud netboot is used by customers (the most common configuration).
The feature is available so rebooting the server through the OVHcloud Control Panel will cause it to load the updated microcode before booting to disk, which will mitigate the vulnerability. 
However, if you are booting on disk without using the OVHcloud netboot system, the mitigation will not be applied and you should consider relying on the Operating-System-level mitigation.

#### Using UEFI

The UEFI firmware update may update the CPU microcode at boot. UEFI firmware updates including the patched microcode will likely be made available by motherboard manufacturers within the next months.

Once available, OVHcloud will include this patched microcode on the UEFI for any new delivered server. Customers will then be able to request an UEFI firmware update by contacting the support.

## As an administrator of a potentially vulnerable server, what should I do?

The first action is to check if your server is impacted by the vulnerability.
You might use the following tool (Linux-only) developed by our team and that has been updated to take in consideration CVE-2022-40982:

```bash
wget https://raw.githubusercontent.com/speed47/spectre-meltdown-checker/master/spectre-meltdown-checker.sh
# sh spectre-meltdown-checker.sh --variant downfall --explain
```

- If the tool says `NOT VULNERABLE` then you are already safe and no further action is needed.

![not vulnerable](images/notvulnerable.png){.thumbnail}

- If the tool says `VULNERABLE` you should then evaluate your exposure to the threat.

![vulnerable](images/vulnerable.png){.thumbnail}

It is necessary to determine if the server context allows to run code from an untrusted origin.<br>
If the server is used to provide services to untrusted end-users that can execute code (VPS, Container, shared hosting, etc.), or is used as a desktop in the cloud browsing the Web (hence possibly running 3rd party JavaScript payloads), then your server might be at risk.<br>
If the server is used only by trusted users and/or does not allow to run untrusted code, the risk of exploitation is probably quite low.
Please note however that this vulnerability might allow an attacker to gain extra privilege in a chained attack, it could be used for persistence or lateral movement in a complex kill chain.

Based on this evaluation, you should determine the emergency to trigger a mitigation and choose the most appropriate one.

## What is OVHcloud working on?

Our technical and support teams are working to ensure the risk is lowered for each of our customers impacted by the vulnerability. We mostly focus on:

- Informing impacted customers to ensure they take the risk into account in their operations and implement mitigation appropriately.
- Developing and integrating updates in our automation to cover the risk in a transparent way for our customers.
- Security watch of the vulnerability exploitation in the wild to define the appropriate extra mitigations we can implement to protect our customer infrastructures.

## External references

<https://www.intel.com/content/www/us/en/developer/topic-technology/software-security-guidance/processors-affected-consolidated-product-cpu-model.html>

<https://downfall.page/>

<https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00828.html>

<https://github.com/speed47/spectre-meltdown-checker/>

<https://github.com/flowyroll/downfall/tree/main/POC>

<https://github.com/torvalds/linux/commit/64094e7e3118aff4b0be8ff713c242303e139834>

<https://github.com/intel/Intel-Linux-Processor-Microcode-Data-Files>

<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-40982>
